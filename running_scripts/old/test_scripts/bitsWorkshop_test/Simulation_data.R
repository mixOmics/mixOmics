# ======================
# The following R script gives the necessary command line for the simulated data from the mixOmics tutorial
# Author: Ignacio Gonzalez
# Reference: @article{Gon12,
#            title={Visualising associations between paired 'omics' data sets},
#            author={Gonz{\'a}lez, Ignacio and L{\^e} Cao, Kim-Anh and Davis, Melissa J and D{\'e}jean, S{\'e}bastien and others},
#            journal={BioData mining},
#            volume={5},
#            number={1},
#            pages={19},
#            year={2012},
#            publisher={BioMed Central Ltd}
#            }
# ======================

library(mvtnorm)

# =====================
# set up the parameters
# =====================
n = 30
nvx = 77
nvy = 33
p = 23
q = 17
nv = p + q + nvx + nvy


# ===========================
# create the covariance matrix
# ============================
vec.sigmaPD <- c(
  1,0.85,0.87,0.89,0.87,0.90,0.92,0.89,0.86,0.82,0,0,0,0,0,0,0,0,0,0,0,0,0,
  -0.72,-0.60,-0.61,-0.54,-0.88,-0.62,-0.61,-0.71,-0.84,-0.70,0,0,0,0,0,0,0,
  0.85,1,0.85,0.83,0.90,0.89,0.91,0.83,0.86,0.84,0,0,0,0,0,0,0,0,0,0,0,0,0,
  -0.62,-0.67,-0.64,-0.64,-0.93,-0.60,-0.79,-0.71,-0.77,-0.65,0,0,0,0,0,0,0,
  0.87,0.85,1,0.84,0.90,0.92,0.93,0.90,0.93,0.90,0,0,0,0,0,0,0,0,0,0,0,0,0,
  -0.64,-0.68,-0.61,-0.57,-0.86,-0.51,-0.63,-0.70,-0.78,-0.64,0,0,0,0,0,0,0,
  0.89,0.83,0.84,1,0.90,0.89,0.93,0.94,0.90,0.86,0,0,0,0,0,0,0,0,0,0,0,0,0,
  -0.70,-0.66,-0.73,-0.59,-0.88,-0.61,-0.67,-0.69,-0.82,-0.67,0,0,0,0,0,0,0,
  0.87,0.90,0.90,0.90,1,0.94,0.96,0.94,0.91,0.92,0,0,0,0,0,0,0,0,0,0,0,0,0,
  -0.65,-0.64,-0.68,-0.61,-0.92,-0.64,-0.75,-0.70,-0.79,-0.70,0,0,0,0,0,0,0,
  0.90,0.89,0.92,0.89,0.94,1,0.95,0.93,0.95,0.92,0,0,0,0,0,0,0,0,0,0,0,0,0,
  -0.68,-0.68,-0.69,-0.65,-0.91,-0.60,-0.69,-0.71,-0.82,-0.66,0,0,0,0,0,0,0,
  0.92,0.91,0.93,0.93,0.96,0.95,1,0.96,0.96,0.95,0,0,0,0,0,0,0,0,0,0,0,0,0,
  -0.71,-0.70,-0.69,-0.59,-0.93,-0.62,-0.71,-0.74,-0.82,-0.68,0,0,0,0,0,0,0,
  0.89,0.83,0.90,0.94,0.94,0.93,0.96,1,0.92,0.90,0,0,0,0,0,0,0,0,0,0,0,0,0,
  -0.73,-0.65,-0.70,-0.61,-0.86,-0.58,-0.66,-0.66,-0.79,-0.67,0,0,0,0,0,0,0,
  0.86,0.86,0.93,0.90,0.91,0.95,0.96,0.92,1,0.92,0,0,0,0,0,0,0,0,0,0,0,0,0,
  -0.63,-0.72,-0.65,-0.58,-0.88,-0.57,-0.67,-0.78,-0.78,-0.63,0,0,0,0,0,0,0,
  0.82,0.84,0.90,0.86,0.92,0.92,0.95,0.90,0.92,1,0,0,0,0,0,0,0,0,0,0,0,0,0,
  -0.67,-0.64,-0.65,-0.56,-0.87,-0.56,-0.64,-0.73,-0.72,-0.60,0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,0,0,0,1,0.85,0.87,0.89,0.87,0.90,0.92,0.89,0.86,0.82,0,0,0,0,
  0,0,0,0,0,0,0,0,0,0.74,0.50,0.68,0.65,0.57,0,0,0,0,0,0,0,0,0,0,0,0,0.85,1,
  0.85,0.83,0.90,0.89,0.91,0.83,0.86,0.84,0,0,0,0,0,0,0,0,0,0,0,0,0,0.78,0.55,
  0.61,0.63,0.63,0,0,0,0,0,0,0,0,0,0,0,0,0.87,0.85,1,0.84,0.90,0.92,0.93,0.90,
  0.93,0.90,0,0,0,0,0,0,0,0,0,0,0,0,0,0.85,0.61,0.60,0.66,0.62,0,0,0,0,0,0,0,
  0,0,0,0,0,0.89,0.83,0.84,1,0.90,0.89,0.93,0.94,0.90,0.86,0,0,0,0,0,0,0,0,0,
  0,0,0,0,0.75,0.60,0.63,0.66,0.69,0,0,0,0,0,0,0,0,0,0,0,0,0.87,0.90,0.90,0.90,
  1,0.94,0.96,0.94,0.91,0.92,0,0,0,0,0,0,0,0,0,0,0,0,0,0.81,0.63,0.62,0.66,
  0.72,0,0,0,0,0,0,0,0,0,0,0,0,0.90,0.89,0.92,0.89,0.94,1,0.95,0.93,0.95,0.92,
  0,0,0,0,0,0,0,0,0,0,0,0,0,0.81,0.60,0.59,0.68,0.65,0,0,0,0,0,0,0,0,0,0,0,0,
  0.92,0.91,0.93,0.93,0.96,0.95,1,0.96,0.96,0.95,0,0,0,0,0,0,0,0,0,0,0,0,0,
  0.81,0.62,0.65,0.67,0.66,0,0,0,0,0,0,0,0,0,0,0,0,0.89,0.83,0.90,0.94,0.94,
  0.93,0.96,1,0.92,0.90,0,0,0,0,0,0,0,0,0,0,0,0,0,0.78,0.65,0.61,0.68,0.71,
  0,0,0,0,0,0,0,0,0,0,0,0,0.86,0.86,0.93,0.90,0.91,0.95,0.96,0.92,1,0.92,0,
  0,0,0,0,0,0,0,0,0,0,0,0,0.79,0.60,0.57,0.59,0.64,0,0,0,0,0,0,0,0,0,0,0,0,
  0.82,0.84,0.90,0.86,0.92,0.92,0.95,0.90,0.92,1,0,0,0,0,0,0,0,0,0,0,0,0,0,
  0.83,0.64,0.53,0.64,0.65,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
  0.94,0.96,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.81,-0.92,0,0,0,0,0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,0,0,0.94,1,0.95,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.81,-0.91,0,
  0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.96,0.95,1,0,0,0,0,0,0,0,0,0,0,0,0,
  0,0,0,0.81,-0.93,-0.72,-0.62,-0.64,-0.70,-0.65,-0.68,-0.71,-0.73,-0.63,
  -0.67,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0.38,0.44,0.40,0.71,0.54,0.47,0.52,0.56,
  0.48,0,0,0,0,0,0,0,-0.60,-0.67,-0.68,-0.66,-0.64,-0.68,-0.70,-0.65,-0.72,
  -0.64,0,0,0,0,0,0,0,0,0,0,0,0,0,0.38,1,0.51,0.55,0.62,0.15,0.63,0.50,0.51,
  0.34,0,0,0,0,0,0,0,-0.61,-0.64,-0.61,-0.73,-0.68,-0.69,-0.69,-0.70,-0.65,
  -0.65,0,0,0,0,0,0,0,0,0,0,0,0,0,0.44,0.51,1,0.64,0.61,0.45,0.62,0.42,0.65,
  0.39,0,0,0,0,0,0,0,-0.54,-0.64,-0.57,-0.59,-0.61,-0.65,-0.59,-0.61,-0.58,
  -0.56,0,0,0,0,0,0,0,0,0,0,0,0,0,0.40,0.55,0.64,1,0.60,0.47,0.49,0.27,0.49,
  0.33,0,0,0,0,0,0,0,-0.88,-0.93,-0.86,-0.88,-0.92,-0.91,-0.93,-0.86,-0.88,
  -0.87,0,0,0,0,0,0,0,0,0,0,0,0,0,0.71,0.62,0.61,0.60,1,0.70,0.73,0.73,0.80,
  0.69,0,0,0,0,0,0,0,-0.62,-0.60,-0.51,-0.61,-0.64,-0.60,-0.62,-0.58,-0.57,
  -0.56,0,0,0,0,0,0,0,0,0,0,0,0,0,0.54,0.15,0.45,0.47,0.70,1,0.36,0.47,0.54,
  0.49,0,0,0,0,0,0,0,-0.61,-0.79,-0.63,-0.67,-0.75,-0.69,-0.71,-0.66,-0.67,
  -0.64,0,0,0,0,0,0,0,0,0,0,0,0,0,0.47,0.63,0.62,0.49,0.73,0.36,1,0.60,0.57,
  0.47,0,0,0,0,0,0,0,-0.71,-0.71,-0.70,-0.69,-0.70,-0.71,-0.74,-0.66,-0.78,
  -0.73,0,0,0,0,0,0,0,0,0,0,0,0,0,0.52,0.50,0.42,0.27,0.73,0.47,0.60,1,0.64,
  0.49,0,0,0,0,0,0,0,-0.84,-0.77,-0.78,-0.82,-0.79,-0.82,-0.82,-0.79,-0.78,
  -0.72,0,0,0,0,0,0,0,0,0,0,0,0,0,0.56,0.51,0.65,0.49,0.80,0.54,0.57,0.64,
  1,0.65,0,0,0,0,0,0,0,-0.70,-0.65,-0.64,-0.67,-0.70,-0.66,-0.68,-0.67,-0.63,
  -0.60,0,0,0,0,0,0,0,0,0,0,0,0,0,0.48,0.34,0.39,0.33,0.69,0.49,0.47,0.49,
  0.65,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.74,0.78,0.85,0.75,0.81,0.81,
  0.81,0.78,0.79,0.83,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0.61,0.51,0.65,0.64,0,0,
  0,0,0,0,0,0,0,0,0,0,0.50,0.55,0.61,0.60,0.63,0.60,0.62,0.65,0.60,0.64,0,
  0,0,0,0,0,0,0,0,0,0,0,0,0.61,1,0.32,0.45,0.68,0,0,0,0,0,0,0,0,0,0,0,0,
  0.68,0.61,0.60,0.63,0.62,0.59,0.65,0.61,0.57,0.53,0,0,0,0,0,0,0,0,0,0,0,
  0,0,0.51,0.32,1,0.60,0.54,0,0,0,0,0,0,0,0,0,0,0,0,0.65,0.63,0.66,0.66,
  0.66,0.68,0.67,0.68,0.59,0.64,0,0,0,0,0,0,0,0,0,0,0,0,0,0.65,0.45,0.60,
  1,0.68,0,0,0,0,0,0,0,0,0,0,0,0,0.57,0.63,0.62,0.69,0.72,0.65,0.66,0.71,
  0.64,0.65,0,0,0,0,0,0,0,0,0,0,0,0,0,0.64,0.68,0.54,0.68,1,0,0,0,0,0,0,0,
  0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.81,0.81,0.81,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  0,1,-0.96,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-0.92,-0.91,-0.93,0,0,
  0,0,0,0,0,0,0,0,0,0,0,0,0,-0.96,1)
sigmaPD <- matrix(vec.sigmaPD,ncol=40)


# ===============================
# create the data sets X and Y
# ===============================

sigma = diag(nv)
sigma[1:(p + q), 1:(p + q)] = sigmaPD

Z = rmvnorm(n = n, mean = rep(0, nv), sigma = sigma, method = "chol")

X = cbind(Z[, 1:p], Z[, (p + q + 1):(p + q + nvx)]) 
colnames(X) = c(paste("XA",1:10,sep=""), paste("XB",1:10,sep=""),
                paste("XC",1:3,sep=""), paste("X", 1:nvx, sep = ""))

Y = cbind(Z[, (p + 1):(p + q)], Z[, (p + q + nvx + 1):nv])
colnames(Y) = c(paste("YA",1:10,sep=""), paste("YB",1:5,sep=""),
                paste("YC",1:2,sep=""), paste("Y", 1:nvy, sep = ""))

# =============================
# create color vector for correlation circle plot
# ============================
library(RColorBrewer)

cols = brewer.pal(7, "Dark2")
col.x <- rep("darkgray", 100)
col.y <- rep("darkgray", 50) 

col.x[1:10] <- cols[1] #"orange"
col.x[11:20] <- cols[4] #"darkgreen"
col.x[21:23] <- "blue3"

col.y[1:10] <- cols[1] #"darkviolet"
col.y[11:15] <- cols[4] #cols[4]
col.y[16] <- "blue3" #"red" 
col.y[17] <- "blue3" #"brown" 
col.simu.var = list(col.x, col.y) 

pch.simu.var = list(rep(16, p + nvx), rep(17, q + nvy))
pch.simu.var[[2]][17] = 20

# =======================
# legend for the correlation circle
# ======================
# plot(0, type = "n", xlab = "", ylab = "", axes = FALSE)
# legend("center", c(expression(X[A]), expression(Y[A]),
#                    expression(X[B]), expression(Y[B]), expression(X[C]),
#                    expression(Y[C]^1), "", expression(Y[C]^2), "X noise", "Y noise"), 
#        box.col = "white", cex = 1.1, pt.bg = "blue3", 
#        pt.cex = c(1.2, 1.2, 1.2, 1.2, 1.2, 1.2, 1.2, 1.1, 1.2, 1.2), 
#        col = c(cols[1], cols[1], cols[4], cols[4],
#                "blue3", "blue3", "white", "blue3", "darkgray", "darkgray"),
#        pch = c(16, 17, 16, 17, 16, 17, 16, 25, 16, 17), ncol = 5)
# 

# ==================
# label of variables for network
# ===================
Xlabels = rep("", 100)
Xlabels[1:10] = rep(expression(X[A]),10)
Xlabels[11:20] = rep(expression(X[B]),10)
Xlabels[21:23] = rep(expression(X[C]),3)

Ylabels = rep("", 50)
Ylabels[1:10] = rep(expression(Y[A]),10)
Ylabels[11:15] = rep(expression(Y[B]),5)
Ylabels[16:17] = c(expression(Y[C]^1),expression(Y[C]^2))	

# =================
# define colors for the CIM
# ================
col.x <- rep("darkgray", 100)
col.y <- rep("darkgray", 50) 
cols = brewer.pal(7, "Dark2")
col.x[1:10] <- cols[1] #"orange"
col.x[11:20] <- cols[4] #"darkgreen"
col.x[21:23] <- "blue3"
col.y[1:10] <- cols[1] #"darkviolet"
col.y[11:15] <- cols[4] #cols[4]
col.y[16] <- "blue3" #"red" 
col.y[17] <- "blue3" #"brown" 
